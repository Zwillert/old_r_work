shiny::runApp()
fil = file.choose()
library(foreign)
data = read.spss(fil)
View(data)
data2 = data.frame(data)
View(data2)
plot(data2[,c(27:38)])
plot(data2[,c(27:31)])
ggplot(data2, aes(THERMO_THERMBLK_W23, THERMO_THERMWHT_W23, col = VOTEGENPOST_W23)) + geom_point()
library(ggplot2)
ggplot(data2, aes(THERMO_THERMBLK_W23, THERMO_THERMWHT_W23, col = VOTEGENPOST_W23)) + geom_point()
ggplot(data2, aes(THERMO_THERMBLK_W23, THERMO_THERMWHT_W23, col = VOTEGENPOST_W23)) + geom_jitter()
ggplot(data2, aes(as.numeric(THERMO_THERMBLK_W230), as.numeric(THERMO_THERMWHT_W23), col = VOTEGENPOST_W23)) + geom_jitter()
ggplot(data2, aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = VOTEGENPOST_W23)) + geom_jitter()
table(data2$VOTEGENPOST_W23, data2$REGRETVOTEA_W23)
table(data2$VOTEGENPOST_W23, data2$VOTEGENPOSTNOW_W23)
table(data2$VOTEGENPOST_W23, data2$VOTEGENPOSTNON_W23)
table(data2$VOTEGENPOST_W23, data2$VOTEDECTIME_W23)
table(data2$VOTEGENPOST_W23, data2$REGRETVOTEB_W23)
knitr::opts_chunk$set(echo = TRUE)
ggplot(data2, aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = VOTEGENPOST_W23), alpha = .2) + geom_jitter()
ggplot(data2, aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = VOTEGENPOST_W23, alpha = .2)) + geom_jitter()
colnames(data2)[which(colnames(data2) == "VOTEGENPOST_W23")] = "Voted_for"
ggplot(data2, aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People") +
ggplot(data2, aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People")
ggplot(data2, aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People")
ggplot(data2, aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People") + guides(alpha = F)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican") , aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People") + guides(alpha = F)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People") + guides(alpha = F)
ggplot(subset(data2, Voted_for != "Donald Trump, the Republican" & Voted_for != "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People") + guides(alpha = F)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMHISP_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Hispanic People") + ylab("Feelings Towards White People") + guides(alpha = F)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People") + guides(alpha = F)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMHISP_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Hispanic People") + ylab("Feelings Towards White People") + guides(alpha = F)
ggplot(subset(data2, Voted_for != "Donald Trump, the Republican" & Voted_for != "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People") + guides(alpha = F)
ggplot(subset(data2, Voted_for != "Donald Trump, the Republican" & Voted_for != "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMHISP_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Hispanic People") + ylab("Feelings Towards White People") + guides(alpha = F)
library(ggridges)
ggplot(data2, aes(x = THERMO_THERMWHT_W23, y = Voted_for, fill = Voted_for)) + geom_density_ridges() + xlab("Feelings Towards Hispanic People") + ylab("Feelings Towards White People") + guides(alpha = F)
ggplot(data2, aes(x = as.numeric(THERMO_THERMWHT_W23), y = Voted_for, fill = Voted_for)) + geom_density_ridges() + xlab("Feelings Towards Hispanic People") + ylab("Feelings Towards White People") + guides(alpha = F)
ggplot(data2, aes(x = as.numeric(THERMO_THERMWHT_W23), y = Voted_for, fill = Voted_for)) + geom_density_ridges() + xlab("Feelings Towards White People") + ylab("Density") + guides(alpha = F)
ggplot(data2, aes(x = as.numeric(THERMO_THERMWHT_W23) - as.numeric(THERMO_THERMHISP_W23), y = Voted_for, fill = Voted_for)) + geom_density_ridges() + xlab("Feelings Towards White People") + ylab("Density") + guides(alpha = F)
ggplot(data2, aes(x = as.numeric(THERMO_THERMWHT_W23) - as.numeric(THERMO_THERMHISP_W23), y = Voted_for, fill = Voted_for)) + geom_density_ridges() + xlab("Feelings Towards White People") + ylab("Density") + guides(alpha = F)
ggplot(subset(data2, Voted_for != "Donald Trump, the Republican" & Voted_for != "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMHISP_W23), as.numeric(THERMO_THERMBLK_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Hispanic People") + ylab("Feelings Towards Black People") + guides(alpha = F)
ggplot(subset(data2, Voted_for != "Donald Trump, the Republican" & Voted_for != "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMHISP_W23), as.numeric(THERMO_THERMBLK_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Hispanic People") + ylab("Feelings Towards Black People") + guides(alpha = F)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" & Voted_for == "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMHISP_W23), as.numeric(THERMO_THERMBLK_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Hispanic People") + ylab("Feelings Towards Black People") + guides(alpha = F)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMHISP_W23), as.numeric(THERMO_THERMBLK_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Hispanic People") + ylab("Feelings Towards Black People") + guides(alpha = F)
ggplot(data2, aes(x = as.numeric(THERMO_THERMWHT_W23) - as.numeric(THERMO_THERMBLK_W23), y = Voted_for, fill = Voted_for)) + geom_density_ridges() + xlab("Feelings Towards White People") + ylab("Density") + guides(alpha = F)
ggplot(data2, aes(x = as.numeric(THERMO_THERMHISP_W23) - as.numeric(THERMO_THERMBLK_W23), y = Voted_for, fill = Voted_for)) + geom_density_ridges() + xlab("Preference of Hispanic People to Black People") + ylab("Density") + guides(alpha = F)
kmeans(data2)
kmeans(data2, centers = 5)
km1  = kmeans(data2, centers = 5)
colsums(is.na(data2))
colSums(is.na(data2))
km1  = kmeans(na.omit(data2), centers = 5)
View(na.omit(data2))
data3 = data2[,-(colSums(is.na(data2)) > 3000)]
View(na.omit(data3))
data3 = data2[,-which(colSums(is.na(data2)) > 3000)]
View(na.omit(data3))
data3 = data2[,-which(colSums(is.na(data2)) > 2000)]
View(na.omit(data3))
km1  = kmeans(na.omit(data3), centers = 5)
table(data3$PLANLIST_I_W23)
km1  = kmeans(na.omit(data3$VOTED_W23), centers = 5)
km1  = kmeans(na.omit(data3$VOTED_W23), centers = 2)
as.numeric(data2$THERMO_THERMASN_W23)
as.numeric(data2$PLANLIST_A_W23)
as.numeric(data2$PLANLIST_H_W23)
View(as.numeric(as.character(data2)))
View(as.numeric(as.character(data2$THERMO_THERMREP_W23)))
typeof(data2)
str(data2)
source('~/.active-rstudio-document', echo=TRUE)
View(data4)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
levels(data3$PLANLIST_C_W23)
length(levels(data3$PLANLIST_C_W23))
length(levels(data3$QKEY))
typeof(data3$PLANLIST_C_W23)
is.factor(data3$PLANLIST_C_W23)
is.factor(data3$QKEY)
source('~/.active-rstudio-document', echo=TRUE)
kmeans(data4[,c(6:10)])
kmeans(data4[,c(6:10)], centers = 4)
data4$"holler" = data4$QKEY
tail(names(data4))
source('~/Documents/shiny1/data_blog/ppp_munge1.R', echo=TRUE)
source('~/Documents/shiny1/data_blog/ppp_munge1.R', echo=TRUE)
source('~/Documents/shiny1/data_blog/ppp_munge1.R', echo=TRUE)
data4$PLANLIST_A_W23 == "0"
source('~/Documents/shiny1/data_blog/ppp_munge1.R', echo=TRUE)
tail(names(data5))
data4["QKEY"]
source('~/Documents/shiny1/data_blog/ppp_munge1.R', echo=TRUE)
summary(data4)
ggplot(data4, aes(VOTEDECTIME_W23, REGRETVOTE_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(data4, aes(VOTEDECTIME_W23, REGRETVOTEA_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data4, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(VOTEDECTIME_W23, REGRETVOTEA_W23, col = VOTEGENPOSTNOW_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(VOTEDECTIME_W23, REGRETVOTEA_W23, col = VOTEGENPOSTNOW_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(VOTEDECTIME_W23, REGRETVOTEA_W23, col = VOTEGENPOSTNON_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data4, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(VOTEDECTIME_W23, REGRETVOTEA_W23, col = VOTEGENPOSTNON_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data4, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(VOTEDECTIME_W23, REGRETVOTEA_W23, col = as.character(VOTEGENPOSTNON_W23))) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(VOTEDECTIME_W23, REGRETVOTEA_W23, col = VOTEGENPOSTNON_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(data4, aes(VOTEDECTIME_W23, REGRETVOTEA_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(VOTEDECTIME_W23, REGRETVOTEA_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23, col = VOTEGENPOSTNOW_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23, col = VOTEGENPOSTNON_W23)) + geom_jitter() + facet_wrap(~Voted_for)
table(data4$VOTEGENPOSTNON_W23)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23, col = as.factor(VOTEGENPOSTNON_W23))) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23)) + geom_tile() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23)) + geom_bar() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes( VOTEDECTIME_W23)) + geom_bar() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes( VOTEDECTIME_W23)) + geom_bar(stat = "identity") + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23)) + geom_bar(stat = "identity") + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23)) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23, col = Voted_for == "Donald Trump, the Republican" )) + geom_jitter() + facet_wrap(~Voted_for)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23, col = Voted_for == "Donald Trump, the Republican" )) + geom_jitter() + facet_wrap(~Voted_for) + guides(col = F)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23, col = Voted_for != "Donald Trump, the Republican" )) + geom_jitter() + facet_wrap(~Voted_for) + guides(col = F)
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23, col = Voted_for != "Donald Trump, the Republican", alpha = .1 )) + geom_jitter() + facet_wrap(~Voted_for) + guides(col = F)
ggplot(subset(data4, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23, col = Voted_for != "Donald Trump, the Republican", alpha = .1 )) + geom_jitter() + facet_wrap(~Voted_for) + guides(col = F)
ggplot(subset(data4[intersect(which(data4$VOTEDECTIME_W23 != "Refused"), which(data4$REGRETVOTEA_W23 != "Refused")),], Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23, col = Voted_for != "Donald Trump, the Republican", alpha = .1 )) + geom_jitter() + facet_wrap(~Voted_for) + guides(col = F)
pppd_munge = function(data = data2){
for(y in 1:ncol(data)){
if(is.factor(data[,y])){
if(length(levels(data[,y])) > 10){
data[,y] = as.numeric(data[,y])
} else {
data[,y] = as.factor(as.character(data[,y]))
}
}
}
return(data)
}
data4 = pppd_munge()
ggplot(subset(data4[intersect(which(data4$VOTEDECTIME_W23 != "Refused"), which(data4$REGRETVOTEA_W23 != "Refused")),], Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23, col = Voted_for != "Donald Trump, the Republican", alpha = .1 )) + geom_jitter() + facet_wrap(~Voted_for) + guides(col = F)
ggplot(subset(data4[intersect(which(data4$VOTEDECTIME_W23 != "Refused"), which(data4$REGRETVOTEA_W23 != "Refused")),], Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat"), aes(REGRETVOTEA_W23, VOTEDECTIME_W23, col = Voted_for != "Donald Trump, the Republican", alpha = .1 )) + geom_jitter() + facet_wrap(~Voted_for) + guides(col = F)
table(subset(data4[intersect(which(data4$VOTEDECTIME_W23 != "Refused"), which(data4$REGRETVOTEA_W23 != "Refused")),c(41,42)], Voted_for == "Donald Trump, the Republican"))
table(subset(data4[intersect(which(data4$VOTEDECTIME_W23 != "Refused"), which(data4$REGRETVOTEA_W23 != "Refused")),], Voted_for == "Donald Trump, the Republican")[,c(41,42)])
t1 = table(subset(data4[intersect(which(data4$VOTEDECTIME_W23 != "Refused"), which(data4$REGRETVOTEA_W23 != "Refused")),], Voted_for == "Donald Trump, the Republican")[,c(41,42)])
plot(t1)
plot(t1)
t1 = table(as.character(subset(data4[intersect(which(data4$VOTEDECTIME_W23 != "Refused"), which(data4$REGRETVOTEA_W23 != "Refused")),], Voted_for == "Donald Trump, the Republican")[,c(41,42)]))
plot(t1)
t1 = table(subset(data4[intersect(which(data4$VOTEDECTIME_W23 != "Refused"), which(data4$REGRETVOTEA_W23 != "Refused")),], Voted_for == "Donald Trump, the Republican")[,c(41,42)])
plot(t1)
t3[,3]
t1[,3]
t1[,-3]
t1 = table(subset(data4[intersect(which(data4$VOTEDECTIME_W23 != "Refused"), which(data4$REGRETVOTEA_W23 != "Refused")),], Voted_for == "Donald Trump, the Republican")[,c(41,42)])[-5,-3]
plot(t1)
plot(t1)
ggplot(t1)
t1d = data.frame(t1)
ggplot(t1d, aes(VOTEDECTIME_W23, REGRETVOTEA_W23)) + geom_tile()
ggplot(t1d, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile()
ggplot(t1d, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(label = Freq)
ggplot(t1d, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq))
t2 = table(subset(data4[intersect(which(data4$VOTEDECTIME_W23 != "Refused"), which(data4$REGRETVOTEA_W23 != "Refused")),], Voted_for ==  "Hillary Clinton, the Democrat")[,c(41,42)])[-5,-3]
plot(t2)
t1d = data.frame(t1)
t2d = data.frame(t2)
t1d$Voted_for = rep(nrow(t1d), "Don")
t1d$Voted_for = rep( "Don", nrow(t1d))
t2d$Voted_for = rep( "Hillary", nrow(t2d))
heat_mat = rbind(t1d, t2d)
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + facet_wrap(~Voted_for)
t1
sum(t1)
t1d = data.frame(t1)/sum(t1)
t2d = data.frame(t2)/sum(t2)
t1d = data.frame(t1)
t1d$Freq = t1d$Freq/sum(t1)
t2d$Freq = t2d$Freq/sum(t2)
t1d$Voted_for = rep( "Don", nrow(t1d))
t2d$Voted_for = rep( "Hillary", nrow(t2d))
heat_mat = rbind(t1d, t2d)
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + facet_wrap(~Voted_for)
t2 = table(subset(data4[intersect(which(data4$VOTEDECTIME_W23 != "Refused"), which(data4$REGRETVOTEA_W23 != "Refused")),], Voted_for ==  "Hillary Clinton, the Democrat")[,c(41,42)])[-5,-3]
t1d = data.frame(t1)
t2d = data.frame(t2)
t1d$Freq = t1d$Freq/sum(t1)
t2d$Freq = t2d$Freq/sum(t2)
t1d$Voted_for = rep( "Don", nrow(t1d))
t2d$Voted_for = rep( "Hillary", nrow(t2d))
heat_mat = rbind(t1d, t2d)
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + facet_wrap(~Voted_for)
t1d = data.frame(t1)
t2d = data.frame(t2)
t1d$Freq = floor((t1d$Freq/sum(t1)) * 1000)/1000
t2d$Freq = floor((t2d$Freq/sum(t2)) * 1000)/1000
t1d$Voted_for = rep( "Don", nrow(t1d))
t2d$Voted_for = rep( "Hillary", nrow(t2d))
heat_mat = rbind(t1d, t2d)
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + facet_wrap(~Voted_for)
t1d = data.frame(t1)
t2d = data.frame(t2)
t1d$Freq = floor((t1d$Freq/sum(t1)) * 100)/100
t2d$Freq = floor((t2d$Freq/sum(t2)) * 100)/100
t1d$Voted_for = rep( "Don", nrow(t1d))
t2d$Voted_for = rep( "Hillary", nrow(t2d))
heat_mat = rbind(t1d, t2d)
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + facet_wrap(~Voted_for)
t1d = data.frame(t1)
t2d = data.frame(t2)
t1d$Voted_for = rep( "Don", nrow(t1d))
heat_mat = rbind(t1d, t2d)
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + facet_wrap(~Voted_for)
t1d = data.frame(t1)
t2d = data.frame(t2)
t1d$Freq = floor((t1d$Freq/sum(t1)) * 1000)/1000
t2d$Freq = floor((t2d$Freq/sum(t2)) * 1000)/1000
t1d$Voted_for = rep( "Don", nrow(t1d))
t2d$Voted_for = rep( "Hillary", nrow(t2d))
heat_mat = rbind(t1d, t2d)
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + facet_wrap(~Voted_for)
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + facet_wrap(~Voted_for) + scale_colour_gradient2(low = "white", high = "red")
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + facet_wrap(~Voted_for) + scale_colour_gradient(low = "white", high = "red")
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + scale_colour_gradient(low = "white", high = "red")+ facet_wrap(~Voted_for)
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + scale_fill_gradient2(low = "white", high = "red") + facet_wrap(~Voted_for)
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + scale_fill_gradient2(low = "blue", high = "red") + facet_wrap(~Voted_for)
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + scale_fill_gradient2(low = "blue", high = "red") + facet_wrap(~Voted_for)
ggplot(heat_mat, aes(VOTEDECTIME_W23, REGRETVOTEA_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + scale_fill_gradient2(low = "blue", high = "red") + facet_wrap(~Voted_for) +xlab("When they decided to vote") + ylab("How they would vote now")
ggplot(heat_mat, aes(,REGRETVOTEA_W23, VOTEDECTIME_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + scale_fill_gradient2(low = "blue", high = "red") + facet_wrap(~Voted_for) +xlab("When they decided to vote") + ylab("How they would vote now")
ggplot(heat_mat, aes(REGRETVOTEA_W23, VOTEDECTIME_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + scale_fill_gradient2(low = "blue", high = "red") + facet_wrap(~Voted_for) +xlab("When they decided to vote") + ylab("How they would vote now")
ggplot(heat_mat, aes(REGRETVOTEA_W23, VOTEDECTIME_W23, fill = Freq)) + geom_tile() + geom_text(aes(label = Freq)) + scale_fill_gradient2(low = "blue", high = "red") + facet_wrap(~Voted_for) +ylab("When they decided to vote") + xlab("How they would vote now")
fil = file.choose()
fil
ggplot(subset(data2, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People") + guides(alpha = F) + geom_density2d()
ggplot(subset(data4, Voted_for == "Donald Trump, the Republican" | Voted_for == "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = Voted_for, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People") + guides(alpha = F)
hist(data4$THERMO_THERMBLK_W23)
ggplot(subset(data4, Voted_for == "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), col = REGRETVOTEB_W23, alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People") + guides(alpha = F)
ggplot(heat_mat, aes(REGRETVOTEA_W23, VOTEDECTIME_W23, fill = Freq, col = REGRETVOTEA_W23)) + geom_tile() + geom_text(aes(label = Freq))  + facet_wrap(~Voted_for) +ylab("When they decided to vote") + xlab("How they would vote now")
ggplot(heat_mat, aes(REGRETVOTEA_W23, VOTEDECTIME_W23, fill = Freq, col = REGRETVOTEB_W23)) + geom_tile() + geom_text(aes(label = Freq))  + facet_wrap(~Voted_for) +ylab("When they decided to vote") + xlab("How they would vote now")
ggplot(subset(data4, Voted_for == "Hillary Clinton, the Democrat") , aes(as.numeric(THERMO_THERMBLK_W23), as.numeric(THERMO_THERMWHT_W23), alpha = .2)) + geom_jitter() + xlab("Feelings Towards Black People") + ylab("Feelings Towards White People") + guides(alpha = F)
ggplot(data4, aes(REGRETVOTEA_W23, VOTEDECTIME_W23,col = REGRETVOTEB_W23)) + geom_jitter() + geom_text(aes(label = Freq))  + facet_wrap(~Voted_for) +ylab("When they decided to vote") + xlab("How they would vote now")
ggplot(data4, aes(REGRETVOTEA_W23, VOTEDECTIME_W23,col = REGRETVOTEB_W23)) + geom_jitter()  + facet_wrap(~Voted_for) +ylab("When they decided to vote") + xlab("How they would vote now")
ggplot(subset(data4, Voted_for == "Hillary Clinton, the Democrat") , aes(REGRETVOTEA_W23, VOTEDECTIME_W23,col = REGRETVOTEB_W23)) + geom_jitter()  + facet_wrap(~Voted_for) +ylab("When they decided to vote") + xlab("How they would vote now")
table(subset(data4, Voted_for == "Hillary Clinton, the Democrat"))$REGRETVOTEB_W23
table(subset(data4, Voted_for == "Hillary Clinton, the Democrat")$REGRETVOTEB_W23)
View(na.omit(subset(data4, Voted_for == "Hillary Clinton, the Democrat")$REGRETVOTEB_W23))
View(na.omit(subset(data4, Voted_for == "Donald Trump, the Republican")$REGRETVOTEB_W23))
table(subset(data4, Voted_for == "Donald Trump, the Republican")$REGRETVOTEB_W23)
source('~/.active-rstudio-document', echo=TRUE)
aapl_opt = getOptionQuote("AAPL")
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
source('~/.active-rstudio-document', echo=TRUE)
quotedata <- read.csv("~/Downloads/quotedata.dat", header=FALSE)
View(quotedata)
library(quantmod)
getOptionChain("AAPL")
op1 = getOptionChain("AAPL")
View(op1[[1]])
source('~/.active-rstudio-document', echo=TRUE)
head(AAPL)
AAPL = getOptionChain("AAPL")
head(AAPL)
install.packages("Quandl")
library(Quandl)
tdotNVUDf9_3zUtzFyP4
apiKey = "tdotNVUDf9_3zUtzFyP4"
library(jsonlite)
Res <- fromJSON('https://query2.finance.yahoo.com/v7/finance/options/AAPL?&date=1471564800')
aop = Res$optionChain$result$strikes
aop = Res$optionChain$result$options
Res <- fromJSON('https://query2.finance.yahoo.com/v7/finance/options/AAPL?')
Res2 <- fromJSON('https://query2.finance.yahoo.com/v7/finance/options/AAPL?&date=1471564800')
as.Date(1471564800)
Res2 <- fromJSON('https://www.google.com/finance/option_chain?q=GOOGL&output=json')
Res2 <- fromJSON('https://www.google.com/finance/option_chain?q=GOOG&output=json')
Res2 <- GET('https://www.google.com/finance/option_chain?q=GOOG&output=csv')
Quandl.api_key(apiKey)
Quandl('CBOE/PUT', start_date='2017-12-22', end_date='2017-12-22')
str(Res$optionChain$result)
View(Res$optionChain$result$options[[1]])
View(Res$optionChain$result$options[[1]]$calls)
View(Res$optionChain$result$options[[1]]$calls[[1]])
Res2 <- fromJSON('https://query2.finance.yahoo.com/v7/finance/options/AAPL?&date=1471564799')
class("1471564799") = "POSIXt"
class(1471564799) = "POSIXt"
as.POSIXct(1471564799)
as.Date(1471564799)
as.POSIXct(1471564799, origin="1970-01-01")
Res2 <- fromJSON('https://query2.finance.yahoo.com/v7/finance/options/AAPL?&date=1471564699')
View(Res2$optionChain$result$options[[1]]$calls[[1]])
Res <- fromJSON('https://query2.finance.yahoo.com/v7/finance/options/AAPL?&date=1471564800')
View(Res$optionChain$result$options[[1]]$calls[[1]])
Res <- fromJSON('https://query2.finance.yahoo.com/v7/finance/options/AAPL?')
View(Res$optionChain$result$options[[1]]$calls[[1]])
as.POSIXct(Res$optionChain$result$expirationDates[[1]], origin="1970-01-01")
library(quantmod)
apo = getOptionChain("AAPL")
apo = quantmod::getOptionChain("AAPL")
apo = quantmod::getOptionChain("AAPL", "2015/2016")
library("httr", lib.loc="/Library/Frameworks/R.framework/Versions/3.3/Resources/library")
GET("https://etws.etrade.com/market/rest/optionchains?expirationMonth=04&expirationYear=2011&chainType=PUT&skipAdjusted=true&underlier=GOOG")
et1 = GET("https://etws.etrade.com/market/rest/optionchains?expirationMonth=04&expirationYear=2011&chainType=PUT&skipAdjusted=true&underlier=GOOG")
g1 = GET("http://www.google.com/finance/option_chain?q=AAPL&expd=4&expm=4&expy=2014&output=json")
View(Res$optionChain$result$options[[1]]$calls[[1]])
ch1 = (Res$optionChain$result$options[[1]]$calls[[1]])
ggplot(ch1, aes(strike, lastPrice)) + geom_point()
ggplot(ch1, aes(strike, lastPrice), col = volume) + geom_point()
ggplot(ch1, aes(strike, lastPrice, col = volume)) + geom_point()
ggplot(ch1, aes(strike, lastPrice, col = volume, size = impliedVolatility)) + geom_point()
ch2 = (Res$optionChain$result$options[[1]]$puts[[1]])
ggplot(ch2, aes(strike, lastPrice, col = volume, size = impliedVolatility)) + geom_point()
